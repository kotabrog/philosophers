# plan

## 仕様
- 哲学者は丸いテーブルを囲み、以下のいずれか一つの行動を行っている
  - eating
  - thinking
  - sleeping
- テーブルの真中にはスペゲティのボウルがおいてある
- テーブルの上にはフォークがいくつかおいてある
- 哲学者は、両手にフォークを１本ずつとって、２本のフォークでスパゲティを食べる。１本では食べれない
- 哲学者は決して飢えてはならない
- 哲学者は飢えないために食べる必要がある
- 哲学者はお互いに会話をしない
- 哲学者は、誰かが死にそうかどうかがわからない
- 哲学者は、食べ終わると、フォークを落として眠り始める
- 哲学者は寝終わると、考え始める
- 哲学者が死ぬと、シュミレーションは終了する
- 各プログラムには以下のオプションが必要
  - number_of_philosophers : 哲学者の数とフォークの数
  - time_to_die : もし最後の食事をはじめてからtime_to_dieミリ秒後に、食事かシュミレーションを始めていなければ死ぬ。
  - time_to_eat : 哲学者が食事にかかる時間（ミリ秒単位）。食事中哲学者は２つのフォークを所有している
  - time_to_sleep : 哲学者が眠る時間（単位はミリ秒）
  - (number_of_times_each_philosopher_must_eat)：オプション。指定した場合は、すべての哲学者がこの数だけ食事をするとシュミレーションは停止する。  
    指定しない場合、誰かが死ぬまでシュミレーションは停止しない。
- 各哲学者には１からnumber_of_philosophersまでの番号がついている
- 哲学者は順番通りに円卓に並んでいる（1とnumber_of_philosophersは隣り合わせ）
- 哲学者のステータスは、以下のように表示される（Xは哲学者番号。timestamp_in_msはミリ秒単位の現在のタイムスタンプ）
  - timestamp_in_ms X has taken a fork 
  - timestamp_in_ms X is eating 
  - timestamp_in_ms X is sleeping 
  - timestamp_in_ms X is thinking 
  - timestamp_in_ms X died 
- 哲学者のステータスの表示は、混ざりって表記が変になるようなことがあってはならない。
- 哲学者が死んでから、その死んだことのステータスの表示まで、10ms以上の時間がかかってはならない
- 使用可能関数（共通）
  - memset
  - printf
  - malloc
  - free
  - write
  - usleep
  - gettimeofday
  - pthread_create
  - pthread_detach
  - pthread_join
- mandatoryの要件
  - 各哲学者の間にフォークがある。つまり、哲学者の右と左にフォークがある(哲学者が一人の場合を除く)
  - 各哲学者が同時に同じフォークを持つことがないように、それぞれのフォークの状態をmutexで保護する必要がある
  - 各哲学者は一つのスレッド
  - プログラムはphiloフォルダの中に格納され、プログラムの名前はphilo
  - 使用可能関数
    - pthread_mutex_init
    - pthread_mutex_destroy
    - pthread_mutex_lock
    - pthread_mutex_unlock
- bonusの要件
  - すべてのフォークは机の中央にある
  - それらはメモリ上にそれぞれのステータスを持つのではなく、利用可能なフォークの数がsemaphoreで表される
  - 各哲学者はプロセスで、メインプロセスは哲学者であってはならない
  - プログラムはphilo_bonusフォルダの中に格納され、プログラムの名前はphilo_bonus
  - 使用可能関数
    - fork
    - kill
    - exit
    - waitpid
    - sem_open
    - sem_close
    - sem_post
    - sem_wait
    - sem_unlink

## todo
- timestamp_in_msの取得
  - [x] gettimeofdayで取得した構造体のtv_usecがこれになる
  - 実装
- usleepの実行時間を短めに設定する（ワカモレ対策）
- debug関数を削除する
- windowsでは-pthread指定だったかがワカモレでもそうか調べる